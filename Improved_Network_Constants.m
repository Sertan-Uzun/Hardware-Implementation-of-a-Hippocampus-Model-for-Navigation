clear;clc;

%------------------------------------------------------------------------

tao_m=50*10^-3; % Time Constants
Rm=20*10^-2;    % Constant Membrane Potential
E_e=0;          % Excitatory Constant Synapse Potential
E_i=-70;        % Inhibitory Constant Synapse Potential
V_thr=-50;      % Threshold Voltage
Vo=-65;         % Resting Potential
r_time=3;       % Refractory Time

h = 0.0001;    % Euler Step Size

%------------------------------------------------------------------------

% Calculation of Conductivity LUT

g_sym = 40*10^-3;    % Time-Dependent Conductivity of the Synapse
tao_1 = 5*10^-3;     % Time Constant of the Synapse    
firing_time = 0.005; % Arbitrary Firing Time

t = 0:0.0001:0.050;     % Time Space
g = zeros(size(t));     % Conductivity Matrix

for i = 1:length(t)
    if t(i) >= firing_time
        g(i) = g_sym * exp(-(t(i) - firing_time) / tao_1);
    end
end

start_idx = find(t >= firing_time, 1);
lut_indices = start_idx-1 : start_idx + 200; 

g_lut = g(lut_indices)*1000; %LUT as 'mS'

%------------------------------------------------------------------------

thr_val = 0.025*1000;       % Perceptron Threshold
g_perceptron=30;            % Perceptron Conductivity

%------------------------------------------------------------------------

% Connection Matrices between Layers

C2 = [
  -0.15989  0.42000  0.07987  -0.11998  0.52000  0.28001  0.13004  0.96973;
  -0.23991  -0.11998  1.50000  0.23978  0.19979  0.48996  -0.20008  -0.35992;
  0.19997  0.43000  -0.32005  0.14991  0.28006  0.39996  -0.04991  0.00000;
  0.00000  -0.23996  0.11980  -0.02018  1.50000  0.23907  1.50000  0.00000;
  0.00000  0.44000  0.43970  1.50000  -0.50000  0.21007  0.15004  0.00000;
  -0.47991  0.00000  1.50000  0.23978  -0.00019  -0.30014  0.71988  0.62998;
  0.00000  -0.23996  0.35982  0.11983  1.50000  1.50000  0.05967  0.40000;
  0.23981  0.00000  0.53004  0.02007  -0.23996  0.44989  0.00000  -0.47994;
];

C3 = [
  1.13928  1.50000  1.50000  1.50000  1.50000  1.50000  1.50000  1.35939;
  0.00000  0.00000  0.00000  0.00000  0.16000  0.00000  0.18000  0.00000;
  0.00000  0.21000  0.00000  0.22000  0.00000  0.00000  0.00000  0.19000;
  0.15990 -0.02026  0.87946  1.38000  0.51964  1.09989  0.76951  1.14949;
  0.00000  0.20000  0.00000  0.00000  0.17000  0.00000  0.22000  0.00000;
  0.23000  0.07978  0.72990 -0.30006  1.50000 -0.04018 -0.30993  0.59985;
  0.24003 -0.12000  0.74985 -0.23993 -0.15995  0.20992 -0.04009  0.83970;
  0.00000  0.00000  0.00000  0.00000  0.20000  0.20000  0.00000  0.00000;
  0.08002  1.50000  0.97969  1.39948  0.19982  1.50000  0.53953  1.11961;
  0.00000  0.00000  0.24000  0.00000  0.00000  0.19000  0.19000  0.00000;
  0.00000  0.00000  0.21000  0.00000  0.00000  0.22000  0.21000  0.00000;
  0.39994  0.11971  1.50000  1.38000  1.38000  0.31958  0.87982  0.19998;
  0.47983  0.31937  1.50000  1.38000  1.38000  0.63928  1.38000  0.63967;
  0.08002  1.50000  0.75969  1.50000  0.36982  1.50000  0.53954  1.03963;
  0.00000  0.00000  0.00000  0.22000  0.00000  0.23000  0.00000  0.00000;
  1.50000  1.50000  1.50000  1.50000  1.50000  1.50000  1.50000  1.50000;
  0.00000  0.00000  0.00000  0.00000  0.00000  0.23000  0.18000  0.17000;
  0.00000  0.00000  0.00000  0.00000  0.00000  0.22000  0.25000  0.00000;
];

%------------------------------------------------------------------------